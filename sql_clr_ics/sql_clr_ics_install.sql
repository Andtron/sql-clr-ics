
-- Make sure Database is owned by same owner as master database
DECLARE @cmd NVARCHAR(MAX)
SELECT @cmd = N'ALTER AUTHORIZATION ON DATABASE::' + QUOTENAME(DB_NAME()) + N' TO ' + QUOTENAME(sp.name)
FROM sys.databases AS db
INNER JOIN sys.server_principals AS sp
ON db.owner_sid = sp.sid
WHERE db.database_id = 1
AND NOT EXISTS (SELECT * FROM sys.databases AS curr WHERE curr.database_id = DB_ID() AND curr.owner_sid = db.owner_sid)

-- Make sure database is trustworthy
IF EXISTS (SELECT * FROM sys.[databases] WHERE database_id = DB_ID() AND is_trustworthy_on = 0 )
BEGIN
    SET @cmd = ISNULL(@cmd + CHAR(13) + CHAR(10), N'') + N'ALTER DATABASE ' + QUOTENAME(DB_NAME()) + N' SET TRUSTWORTHY ON;';
END

IF @cmd IS NOT NULL
BEGIN
	PRINT @cmd;
	EXEC (@cmd);
END
GO
-- Make sure clr is enabled
DECLARE @InitAdvanced INT

IF EXISTS (select * from sys.configurations where name IN ('clr enabled') and value_in_use = 0)
BEGIN
	SELECT @InitAdvanced = CONVERT(int, value) FROM sys.configurations WHERE name = 'show advanced options';

	IF @InitAdvanced = 0
	BEGIN
		EXEC sp_configure 'show advanced options', 1;
		RECONFIGURE;
	END

	IF EXISTS (select * from sys.configurations where name = 'clr enabled' and value_in_use = 0)
	BEGIN
		EXEC sp_configure 'clr enabled', 1;
		RECONFIGURE;
	END

	IF @InitAdvanced = 0
	BEGIN
		EXEC sp_configure 'show advanced options', 0;
		RECONFIGURE;
	END
END
GO
IF OBJECT_ID('clr_send_ics_invite') IS NOT NULL DROP PROCEDURE [dbo].[clr_send_ics_invite]
GO
IF EXISTS (SELECT * FROM sys.assemblies WHERE name = 'sql_clr_ics') DROP ASSEMBLY [sql_clr_ics];
GO
PRINT N'Creating Assembly [dbo].[sql_clr_ics]...';
GO
CREATE ASSEMBLY [sql_clr_ics]
    AUTHORIZATION [dbo]
    FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103007BBEE25C0000000000000000E00022200B013000002200000008000000000000B241000000200000006000000000001000200000000200000400000000000000060000000000000000A000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000604100004F000000006000000404000000000000000000000000000000000000008000000C000000284000001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000B8210000002000000022000000020000000000000000000000000000200000602E7273726300000004040000006000000006000000240000000000000000000000000000400000402E72656C6F6300000C0000000080000000020000002A0000000000000000000000000000400000420000000000000000000000000000000094410000000000004800000002000500902800009817000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300500CE0700000100001100730E00000A0A0F00280F00000A2D0E0F00281000000A281100000A2B0117130811082C0C0672010000706F1200000A260F01280F00000A2D0E0F01281000000A281100000A2B0117130911092C0C0672310000706F1200000A260F04280F00000A2D0E0F04281000000A281100000A2B0117130A110A2C0C06725D0000706F1200000A26066F1300000A16FE02130B110B2C11729300007006281400000A731500000A7A0F07281600000A130C110C2C1E281700000A130D120D230000000000C07240281800000A281900000A10070F08281600000A130E110E2C200F07281A00000A130D120D230000000000004E40281800000A281900000A10080F10281B00000A130F110F2C091F0F281C00000A10100F0F281D00000A131011102C0817281E00000A100F0F14281D00000A131111112C0816281E00000A10140F0A280F00000A2D0E0F0A281000000A281100000A2B0117131211122C0C72F5000070281F00000A100A0F0B281B00000A131311132C091F19281C00000A100B0F0C281D00000A131411142C0816281E00000A100C0F09281600000A131511152C0C282000000A281900000A1009160B282100000A0C0F0D280F00000A2D0E0F0D281000000A281100000A2B0117131611162C0600170B002B40000F0E280F00000A2D0E0F0E281000000A281100000A2B0117131711172C0C7209010070281F00000A100E0F0D281000000A0F0E281000000A732200000A0C000F12282300000A16FE01131811182C150E130F12282400000A282500000A81140000012B110E13282600000A282500000A8114000001732700000A0D090F04281000000A6F2800000A00090F05281000000A6F2900000A0000090F00281000000A732A00000A6F2B00000A0000DE1A131900720B01007011196F2C00000A282D00000A731500000A7A00000F03280F00000A2D110F03281000000A281100000A16FE012B0116131A111A2C1C096F2E00000A0F03281000000A1F3B1F2C6F2F00000A6F3000000A0000DE1A131B00723F010070111B6F2C00000A282D00000A731500000A7A0000096F3100000A0F01281000000A1F3B1F2C6F2F00000A6F3000000A0000DE1A131C007279010070111C6F2C00000A282D00000A731500000A7A00000F02280F00000A2D110F02281000000A281100000A16FE012B0116131D111D2C1C096F3200000A0F02281000000A1F3B1F2C6F2F00000A6F3000000A0000DE1A131E0072A9010070111E6F2C00000A282D00000A731500000A7A730E00000A1304110472D90100706F1200000A26110472F90100706F1200000A26110472330200706F1200000A260F12282300000A131F111F2C1E001104724B0200706F1200000A26110472690200706F1200000A26002B1C001104727F0200706F1200000A261104729B0200706F1200000A2600110472B10200706F1200000A26110472CB0200700F07281A00000A8C19000001283300000A6F1200000A26110472050300700F09281A00000A8C19000001283300000A6F1200000A261104723F0300700F08281A00000A8C19000001283300000A6F1200000A260F06280F00000A16FE01132011202C19110472750300700F06281000000A282D00000A6F1200000A261104728B0300700E13282400000A8C22000001283300000A6F1200000A261104729B030070096F3400000A283300000A6F1200000A26110472BB030070096F3400000A283300000A6F1200000A26110472FD030070096F3500000A283300000A6F1200000A2611047215040070096F3600000A6F3700000A283300000A6F1200000A260F11283800000A2D07723F0400702B057279040070130516130600096F3100000A6F3900000A13212B4D11216F3A00000A13220011226F3700000A096F3600000A6F3700000A283B00000A132311232C03171306110472B904007011226F3C00000A11226F3700000A1105283D00000A6F1200000A260011216F3E00000A2DAADE0D11212C0811216F3F00000A00DC110616FE01132411242C2811047268050070096F3600000A6F3C00000A096F3600000A6F3700000A284000000A6F1200000A260E0F13261126284100000A2D1511260F12282300000A281E00000A284200000A2B021126284300000A132511252C5400110472490600706F1200000A26110472630600700F10284400000A8C27000001283300000A6F1200000A26110472830600706F1200000A26110472A10600706F1200000A26110472CB0600706F1200000A2600110472E10600706F1200000A26110472F70600706F1200000A26734500000A13070011070F0A281000000A6F4600000A0011070F0B284400000A6F4700000A001107076F4800000A0011070F0C283800000A6F4900000A001107086F4A00000A007213070070734B00000A132711276F4C00000A722F070070723D0700706F4D00000A0011276F4C00000A724D07007072570700706F4D00000A000F05281000000A726F070070734B00000A284E00000A1328096F4F00000A11286F5000000A0011046F5100000A1127284E00000A1329096F4F00000A11296F5000000A00096F5200000A7283070070729F0700706F5300000A0000DE1A132A0072E7070070112A6F2C00000A282D00000A731500000A7A00001107096F5400000A000E14285500000A284300000A132B112B2C21285600000A722B0800700E13282400000A8C22000001283300000A6F5700000A0000DE1A132C00726D080070112C6F2C00000A282D00000A731500000A7A2A00000158000000006F021786021A1A0000010000A10241E2021A1A0000010000FD02201D031A1A000001000038034179031A1A000001020043055A9D050D0000000000008106D758071A1A0000010000730740B3071A1A0000012202285800000A002A00000042534A4201000100000000000C00000076342E302E33303331390000000005006C000000C8040000237E0000340500007007000023537472696E677300000000A40C000098080000235553003C1500001000000023475549440000004C1500004C02000023426C6F620000000000000002000001471502080900000000FA013300160000010000002C000000020000000200000015000000580000000D00000001000000030000000100000003000000000090030100000000000600760207050600E30207050600C101F4040F00380500000600D501F30306005902F30306003A02F3030600CA02F30306009602F3030600AF02F30306000202F30306001D02F30306009F01270506004F06C1030A00EC01A1040A0013035E050A0046015E050A001C005E050A00DF035E050A00B5005E0506006E04F5060E00D90676060E00F50080030E008D06800306004901C10306004704C10306000E004D000E00220680030E006E0136010E000C07800306003D03C1030E00010176060E004F0376060600C000C1030E00190480030600010061030600C804E80506001101C10306001F00C1030E00440796000E002F0480030E00050496000A000107A1040A006601A1040000000025000000000001000100010010007305000039000100010050200000000096008B01740101008428000000008618E2040600160000000100DA03000002005E04000003004A00000004005804000005006E06000006003F0700000700EA0300000800750000000900680000000A00840000000B00BC0400000C00BB0600000D00B90300000E002D0100000F00D800000010007C04000011008F050000120061040000130089040200140090040000150047050900E20401001100E20406001900E2040A002900E20410003100E20410003900E20410004100E20410004900E20410005100E20410005900E20410006100E20410006900E20410007900E2040600A900E20406008100A0035B00810001035F00F90061076300A90052016800A90044036E00F90041067200D100E20410008900A0035B00C9001A077800C90084057D00890081068300890001038A009100A0035B00910081068F009900A0035B00990081069500810081069B00C900220778000101B005A1000901E204A700A100A0035B00A1000103AD00A1008106B3001101BD00BB00B900E2040600B90062061000B90036071000E100E2041000B900D103C100D100E9005F00F9004106C700B900C006CD00F900E100D300190192001000B9005104CD00B9002E00CD00F9004806D900B9002D075F00B90056065F00B900C803DF00E10016065F00990001035B000C00D404EC0014009806FC00F90055070101E1001D015F00F900480607012901EC065B00310183010600F90048060F0199007A0116019900C5001C0199000B031601910001036E00C100E2040600C100D0061000C100B2060100C100CE052501C100AB032501C100A0052A01E900E2041000E9000706300141019200A700F1001D033601B9002E063E011C0092004C0171003B035F00B900FB05520151019200A700C100D30058019900A4065E0159015D0165016101D30010007100E204060020006B0045022E000B00A3012E001300AC012E001B00CB012E002300D4012E002B00E5012E00330015022E003B001B022E004300D4012E004B001B022E0053001B022E005B002D022E0063003A021500E400F5004401048000000100000000000000000000000000E80400000400000000000000000000006B014100000000000400000000000000000000006B013500000000000400000000000000000000006B01C103000000000000000000436F6C6C656374696F6E60310049456E756D657261746F7260310053716C496E743332003C4D6F64756C653E006765745F43430053797374656D2E44617461006D73636F726C69620063630053797374656D2E436F6C6C656374696F6E732E47656E6572696300656E645F74696D655F7574630073746172745F74696D655F7574630074696D657374616D705F757463004164640053797374656D2E436F6C6C656374696F6E732E5370656369616C697A65640053716C47756964004E657747756964006F705F42697477697365416E640053656E640070617373776F7264005265706C616365006765745F4D657373616765004D61696C4D6573736167650043726564656E7469616C43616368650049446973706F7361626C65006765745F446973706C61794E616D6500757365726E616D650053797374656D2E4E65742E4D696D650053716C4461746554696D6500417070656E644C696E65006765745F506970650053716C5069706500436F6E74656E7454797065006F705F46616C736500446973706F736500636C725F73656E645F6963735F696E76697465004E65757472616C5265736F75726365734C616E67756167654174747269627574650044656275676761626C6541747472696275746500417373656D626C795469746C654174747269627574650053716C50726F63656475726541747472696275746500417373656D626C7954726164656D61726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465006765745F56616C7565006F705F547275650053716C537472696E6700437265617465416C7465726E6174655669657746726F6D537472696E6700546F537472696E67006765745F4C656E677468004E6574776F726B43726564656E7469616C0053797374656D2E436F6C6C656374696F6E732E4F626A6563744D6F64656C0053797374656D2E4E65742E4D61696C0073716C5F636C725F6963732E646C6C006765745F49734E756C6C007365745F456E61626C6553736C007573655F73736C0053797374656D006765745F46726F6D007365745F46726F6D0066726F6D0053716C426F6F6C65616E006C6F636174696F6E0053797374656D2E5265666C656374696F6E004E616D6556616C7565436F6C6C656374696F6E004D61696C41646472657373436F6C6C656374696F6E00416C7465726E61746556696577436F6C6C656374696F6E00457863657074696F6E006765745F546F007265706C795F746F00726571756972655F7273767000537472696E674275696C646572007573655F72656D696E6465720063616E63656C5F6576656E745F6964656E746966696572004D6963726F736F66742E53716C5365727665722E53657276657200736D74705F7365727665720049456E756D657261746F7200476574456E756D657261746F72002E63746F720073716C5F636C725F6963730053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E436F6D70696C657253657276696365730053797374656D2E5265736F757263657300446562756767696E674D6F6465730073757070726573735F696E666F5F6D657373616765730053797374656D2E446174612E53716C54797065730053746F72656450726F63656475726573004164644D696E757465730072656D696E6465725F6D696E75746573007365745F43726564656E7469616C73006765745F44656661756C744E6574776F726B43726564656E7469616C73007365745F55736544656661756C7443726564656E7469616C730053797374656D2E436F6C6C656374696F6E73006765745F48656164657273006765745F506172616D6574657273006765745F41646472657373004D61696C41646472657373006765745F416C7465726E617465566965777300436F6E63617400466F726D6174004F626A656374006765745F5375626A656374007365745F5375626A656374007375626A6563740053797374656D2E4E6574006F705F496D706C6963697400536D7470436C69656E74006765745F43757272656E74006F705F4C6F676963616C4E6F74007365745F506F727400706F7274006765745F5265706C79546F4C697374007365745F486F7374004943726564656E7469616C734279486F7374004D6F76654E6578740053797374656D2E546578740053716C436F6E7465787400416C7465726E61746556696577006765745F4E6F77006765745F5574634E6F77006765745F426F6479007365745F426F647900626F647900537472696E6744696374696F6E617279006F705F457175616C6974790049734E756C6C4F72456D7074790000002F4D0069007300730069006E006700200070006100720061006D0065007400650072003A002000660072006F006D00002B4D0069007300730069006E006700200070006100720061006D0065007400650072003A00200074006F0000354D0069007300730069006E006700200070006100720061006D0065007400650072003A0020007300750062006A00650063007400006155006E00610062006C006500200074006F002000730065006E00640020006D00610069006C002000640075006500200074006F002000760061006C00690064006100740069006F006E0020006500720072006F0072002800730029003A00200000136C006F00630061006C0068006F007300740000010033460072006F006D0020006100640064007200650073007300200069007300200069006E00760061006C00690064003A00200000395200650070006C00790054006F0020006100640064007200650073007300200069007300200069006E00760061006C00690064003A002000002F54006F0020006100640064007200650073007300200069007300200069006E00760061006C00690064003A002000002F4300430020006100640064007200650073007300200069007300200069006E00760061006C00690064003A002000001F42004500470049004E003A005600430041004C0045004E004400410052000039500052004F004400490044003A002D002F002F005300630068006500640075006C0065002000610020004D0065006500740069006E0067000117560045005200530049004F004E003A0032002E003000001D4D004500540048004F0044003A0052004500510055004500530054000015530045005100550045004E00430045003A003000001B4D004500540048004F0044003A00430041004E00430045004C000015530045005100550045004E00430045003A003100001942004500470049004E003A0056004500560045004E005400003944005400530054004100520054003A007B0030003A0079007900790079004D004D00640064005400480048006D006D00730073005A007D000039440054005300540041004D0050003A007B0030003A0079007900790079004D004D00640064005400480048006D006D00730073005A007D0000354400540045004E0044003A007B0030003A0079007900790079004D004D00640064005400480048006D006D00730073005A007D0000154C004F0043004100540049004F004E003A002000000F5500490044003A007B0030007D00001F4400450053004300520049005000540049004F004E003A007B0030007D00004158002D0041004C0054002D0044004500530043003B0046004D00540054005900500045003D0074006500780074002F00680074006D006C003A007B0030007D000117530055004D004D004100520059003A007B0030007D0000294F005200470041004E0049005A00450052003A004D00410049004C0054004F003A007B0030007D000039500041005200540053005400410054003D00410043004300450050005400450044003B0052005300560050003D00460041004C0053004500003F500041005200540053005400410054003D004E0045004500440053002D0041004300540049004F004E003B0052005300560050003D0054005200550045000180AD41005400540045004E004400450045003B004300550054005900500045003D0049004E0044004900560049004400550041004C003B0052004F004C0045003D005200450051002D005000410052005400490043004900500041004E0054003B007B0032007D003B0043004E003D0022007B0030007D0022003B0058002D004E0055004D002D004700550045005300540053003D0030003A006D00610069006C0074006F003A007B0031007D000180DF41005400540045004E004400450045003B004300550054005900500045003D0049004E0044004900560049004400550041004C003B0052004F004C0045003D004E004F004E002D005000410052005400490043004900500041004E0054003B00500041005200540053005400410054003D00410043004300450050005400450044003B0052005300560050003D00460041004C00530045003B0043004E003D0022007B0030007D0022003B0058002D004E0055004D002D004700550045005300540053003D0030003A006D00610069006C0074006F003A007B0031007D00011942004500470049004E003A00560041004C00410052004D00001F54005200490047004700450052003A002D00500054007B0030007D004D00011D41004300540049004F004E003A0044004900530050004C004100590000294400450053004300520049005000540049004F004E003A00520065006D0069006E00640065007200001545004E0044003A00560041004C00410052004D00001545004E0044003A0056004500560045004E005400001B45004E0044003A005600430041004C0045004E00440041005200001B74006500780074002F00630061006C0065006E00640061007200000D6D006500740068006F006400000F520045005100550045005300540000096E0061006D00650000174D0065006500740069006E0067002E00690063007300001374006500780074002F00680074006D006C00001B43006F006E00740065006E0074002D0063006C006100730073000147750072006E003A0063006F006E00740065006E0074002D0063006C00610073007300650073003A00630061006C0065006E006400610072006D00650073007300610067006500014353004D0054005000200043006C00690065006E007400200043006F006E00660069006700750072006100740069006F006E0020004500720072006F0072003A00200000414D00610069006C002000530065006E0074002E0020004500760065006E00740020004900640065006E007400690066006900650072003A0020007B0030007D0000294500720072006F0072002000730065006E00640069006E00670020006D00610069006C003A00200000008B63F2930F18DC4F822439AA2ADA67FB00042001010803200001052001011111042001010E45072D1255021259125D12550E02126102020202021165020202020202020202020212690212691269021269020215126D0112711271020202114D1275127912791269021269032000020320000E040001020E05200112550E032000080500020E1C1C040000116505200111650D060001114511650420001165050001114908050001114D0205000111410E050000128085052002010E0E05200011808907000111511180890500001180890520010112710500020E0E0E05200012808D0520020E03030500020E0E1C0420001271071512809101127108200015126D0113000615126D0112710420001300050002020E0E0700040E0E1C1C1C0600030E0E1C1C05000102114D080002114D114D114D04200101020520010112590520001280A107000212790E12750520001280A507151280910112790520010113000520001280A905200101125D060001114D114D0500001280B108B77A5C561934E0892E001501114111411141114111411141114111451145114511411149114D11411141114D1149114D1151101151114D0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000701000000001001000B73716C5F636C725F69637300002F01002A53656E64204943532063616C656E64617220696E7669746573207573696E672053514C2053657276657200000501000000001101000C456974616E20426C756D696E00000C010007312E302E302E3000000A010005656E2D5553000004010000000000000000007BBEE25C00000000020000001C0100004440000044220000525344536F90C957F826E94D9D051ED792100F7E01000000433A5C55736572735C757365725C536F757263655C5265706F735C73716C5F636C725F6963735C73716C5F636C725F6963735C6F626A5C44656275675C73716C5F636C725F6963732E70646200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000884100000000000000000000A241000000200000000000000000000000000000000000000000000094410000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF250020001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058600000A80300000000000000000000A80334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B00408030000010053007400720069006E006700460069006C00650049006E0066006F000000E402000001003000300030003000300034006200300000006E002B00010043006F006D006D0065006E00740073000000530065006E00640020004900430053002000630061006C0065006E00640061007200200069006E007600690074006500730020007500730069006E0067002000530051004C002000530065007200760065007200000000003A000D00010043006F006D00700061006E0079004E0061006D0065000000000045006900740061006E00200042006C0075006D0069006E000000000040000C000100460069006C0065004400650073006300720069007000740069006F006E0000000000730071006C005F0063006C0072005F006900630073000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E003000000040001000010049006E007400650072006E0061006C004E0061006D0065000000730071006C005F0063006C0072005F006900630073002E0064006C006C0000003E000D0001004C006500670061006C0043006F007000790072006900670068007400000045006900740061006E00200042006C0075006D0069006E000000000042000D0001004C006500670061006C00540072006100640065006D00610072006B0073000000000045006900740061006E00200042006C0075006D0069006E00000000004800100001004F0072006900670069006E0061006C00460069006C0065006E0061006D0065000000730071006C005F0063006C0072005F006900630073002E0064006C006C00000038000C000100500072006F0064007500630074004E0061006D00650000000000730071006C005F0063006C0072005F006900630073000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E00300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000C000000B43100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    WITH PERMISSION_SET = UNSAFE;
GO
ALTER ASSEMBLY [sql_clr_ics]
    DROP FILE ALL
    ADD FILE FROM 0x4D6963726F736F667420432F432B2B204D534620372E30300D0A1A445300000000020000020000001B0000008C000000000000001A000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000C0FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF380000F8FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0BCA3101380000000010000000100000000000000E00FFFF04000000FFFF03000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BCA3101380000000010000000100000000000000F00FFFF04000000FFFF0300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000942E31017BBEE25C010000006F90C957F826E94D9D051ED792100F7E00000000000000000100000001000000000000000000000000000000DC51330100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BCA310138000000001000000010000000000000FFFFFFFF04000000FFFF030000000000FFFFFFFF00000000FFFFFFFF00000000FFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BCA310138000000001000000010000000000000FFFFFFFF04000000FFFF030000000000FFFFFFFF00000000FFFFFFFF00000000FFFFFFFF000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F862513FC607D311905300C04FA302A1C4454B99E9E6D211903F00C04FA302A10B9D865A1166D311BD2A0000F80849BDEC1618FF5EAA104D87F76F496383346014000000000000001AB91FB23E0162314ECD74DC1F3BEEE69189979C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000CE07000000000000CE070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FEEFFEEF010000009600000000433A5C55736572735C757365725C536F757263655C5265706F735C73716C5F636C725F6963735C73716C5F636C725F6963735C636C725F73656E645F6963735F696E766974652E63730000633A5C75736572735C757365725C736F757263655C7265706F735C73716C5F636C725F6963735C73716C5F636C725F6963735C636C725F73656E645F6963735F696E766974652E63730004000000010000004B0000004C000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001BE2300180000000EADC753B1B0FD50101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000020000000100000001000000000000004C000000280000001BE23001349634835C000000010000004B0000004C000000650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000003E002A11000000006804000000000000CE070000000000000000000001000006000000000100000000636C725F73656E645F6963735F696E76697465000000001600031104000000A8030000CE07000000000000010000000A0024115553797374656D00120024115553797374656D2E54657874000000000E0024115553797374656D2E4E657400160024115553797374656D2E4E65742E4D61696C000000001A0024115553797374656D2E446174612E53716C54797065730000001E0020110000000001000011000000000000000073625F4572726F72730000002A0020110100000001000011000000000000000075736544656661756C7443726564656E7469616C730000001E0020110200000001000011000000000000000063726564656E7469616C730016002011030000000100001100000000000000006D7367001600201104000000010000110000000000000000737472001E00201105000000010000110000000000000000727376705F737472696E67002A002011060000000100001100000000000000006F7267616E697A65725F696E5F726563697069656E7473001E00201107000000010000110000000000000000736D7470636C69656E7400001600031144000000F80100001A00000086020000010000001600201119000000010000110000000000000000650000000200060016000311440000002C0200001A000000E202000001000000160020111B00000001000011000000000000000065000000020006001600031144000000600200001A0000001D03000001000000160020111C00000001000011000000000000000065000000020006001600031144000000940200001A0000007903000001000000160020111E00000001000011000000000000000065000000020006001600031144000000CC0200004D00000045050000010000001A0020112200000001000011000000000000000061646472000000000200060016000311440000003C030000D500000081060000010000001A00201127000000010000110000000000000000636F6E74797065001A0020112800000001000011000000000000000048544D4C000000001A00201129000000010000110000000000000000617643616C000000020006001600031144000000700300001A0000005807000001000000160020112A00000001000011000000000000000065000000020006001600031144000000A40300001A000000B307000001000000160020112C000000010000110000000000000000650000000200060002000600BA000404C93FEAC6B359D649BC250902BBABB460000000004D0044003200000004020000040000000C00000001000500040600038C00000001390184F60185310187FE018CC10191A10192180196B602650280D402813D0281B7028284000282D802832F02836C0283A30283F102845802847D0284AB0285800286240286D80188C602895C0189EC018AC7028B5B018BD0028D74028FCE069244019244029281029392029477000198320199010199B5019AA1029B9C019C6000000002000600F2000000640800000000000001000100CE07000000000000B10000005808000000000000130000800100000016000080070000001800008021000000EEEFFE80250000001800008031000000190000804B000000EEEFFE804F000000190000805B0000001A00008075000000EEEFFE80790000001A000080850000001C00008090000000EEEFFE80940000001C000080A500000022000080AE000000EEEFFE80B200000022000080D000000023000080D9000000EEEFFE80DD00000023000080FD0000002400008006010000EEEFFE800A0100002400008013010000250000801C010000EEEFFE802001000025000080280100002600008031010000EEEFFE8035010000260000803D0100002800008057010000EEEFFE805B01000028000080670100002900008070010000EEEFFE8074010000290000807D0100002A00008086010000EEEFFE808A0100002A000080920100002B0000809B010000EEEFFE809F0100002B000080AB0100002D000080AD0100002E000080B301000030000080CD010000EEEFFE80D101000031000080D201000032000080D401000033000080D701000035000080D801000036000080F2010000EEEFFE80F60100003600008002020000370000801602000038000080170200003A00008023020000EEEFFE80270200003B0000803C0200003D0000804D02000043000080530200004400008061020000450000806F020000480000807002000049000080830200004A000080860200004B000080880200004C000080890200004D000080A0020000EEEFFE80A102000051000080A202000052000080BF020000EEEFFE80C302000052000080DF02000053000080E202000054000080E402000055000080E502000056000080FC020000EEEFFE80FD0200005A000080FE0200005B0000801A0300005C0000801D0300005D0000801F0300005E000080200300005F00008037030000EEEFFE803803000063000080390300006400008056030000EEEFFE805A03000064000080760300006500008079030000660000807B030000670000807C03000068000080930300006F0000809A03000070000080A703000071000080B403000072000080C103000074000080CA030000EEEFFE80CE03000075000080CF03000076000080DC03000077000080E903000078000080EC0300007A000080ED0300007B000080FA0300007C000080070400007D000080080400007F0000801504000080000080330400008100008051040000820000806F040000830000807B040000EEEFFE807F040000830000809804000084000080B604000085000080CE04000086000080E604000087000080FE040000880000801B0500008A000080320500008B000080350500008D000080360500008D00008043050000EEEFFE80450500008D0000804E0500008E0000804F0500008F00008068050000EEEFFE806C0500008F0000806F050000900000809105000091000080920500008D0000809D050000EEEFFE80A9050000EEEFFE80AA05000093000080B1050000EEEFFE80B505000093000080DD0500009500008008060000EEEFFE800C060000960000800D060000970000801A060000980000803806000099000080450600009A000080520600009B0000805F0600009C000080600600009E0000806D0600009F0000807A060000A500008081060000A800008082060000A900008091060000AA000080A0060000AB000080A9060000AC000080B8060000AD000080C1060000AE000080CD060000AF000080E4060000B0000080FB060000B200008013070000B300008021070000B400008031070000B50000803F070000B700008055070000B800008058070000B90000805A070000BA0000805B070000BB00008072070000EEEFFE8073070000C100008074070000C20000807D070000C30000808B070000EEEFFE808F070000C4000080B0070000C5000080B3070000C6000080B5070000C7000080B6070000C8000080CD070000CA000080050006000900370009003D00000000003E006E0009003900000000003A006800090043000000000044007700090022000000000023007700090023000000000024005300090021000000000022005600090025000000000026003C0009002100000000002200360009002B00000000002C004B0009004B00000000004C00660009001900000000001A00240009001C00000000001D002D0009002200000000002300430009002C0009005F00090045000000000009000A000D002A0009000A0009000A000D004900000000004A0058000D00510009000A0009002D00000000000D003E000D002F0009002D000900250009001F0009000A000D00340009000A0009001C0009000A000D004A000000000009000A000D004B00000000004C00820009000A0009001C0009000A000D004D000000000009000A000D00340009000A0009001C0009000A000D0048000000000009000A000D003F00000000004000670009000A0009001C0009000A000D0048000900310009002B00090038000900270009002C000000000009000A000D002E000D002A0009000A0009000A000D002D000D002A0009000A000900280009005D0009005C000900590009001E00000000001F004D0009004A00090044000900550009004300090051000900780009002E000900100026002C00000000001200220009000A000D00320000000000330052000D00B40009000A0023002500000000000000000009002600000000002700E20009003C000000000009000A000D002C000D0056000D002E000D0034000D002A0009000A0009002600090029000900520009000A000D0031000D002A000D0046000D0032000D0032000D0064000D0039000D003B000D0088000D002A000D0068000D002B000D00550009000A0009001C0009000A000D0052000000000009000A000D0022000D0029000000000011008C0009000A0009001C0009000A000D00450005000600F400000008000000010000000000000008000000000000002400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFFFFFFF1A092FF1100000000C02000025000000010000000100000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002200251100000000040000000100636C725F73656E645F6963735F696E76697465000000160029110000000004000000010030363030303030310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000FFFFFFFF1A092FF10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFFFFFFF77093101010000000B00108E0C0084690D0006005C000000200000002C00000058000000000000000000000016000000190000000000EEC00000000000000000FFFF000000000000FFFFFFFF00000000FFFF0000000000000000000000000A006C040000000000007C0800000100000000000000000000000000000053746F72656450726F636564757265730043444135313336460000002DBA2EF10100000000000000CE07000000000000000000000000000000000000020002000D01000000000100FFFFFFFF00000000CE0700000802000000000000FFFFFFFF00000000FFFFFFFF010001000000010000000000433A5C55736572735C757365725C536F757263655C5265706F735C73716C5F636C725F6963735C73716C5F636C725F6963735C636C725F73656E645F6963735F696E766974652E6373000000FEEFFEEF010000000100000000010000000000000000000000FFFFFFFFFFFFFFFFFFFF0900FFFFFFFFFFFFFFFFFFFF00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000942E31017BBEE25C010000006F90C957F826E94D9D051ED792100F7E770000002F4C696E6B496E666F002F6E616D6573002F7372632F686561646572626C6F636B002F7372632F66696C65732F633A5C75736572735C757365725C736F757263655C7265706F735C73716C5F636C725F6963735C73716C5F636C725F6963735C636C725F73656E645F6963735F696E766974652E6373000400000006000000010000001B00000000000000220000000800000011000000070000000A00000006000000000000000500000000000000DC513301000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E00000020000000D3000000380000006F0100003800000000000000BA000000800000005C00000028000000F40C00002C0200002C0000003C00000003000000180000000600000017000000070000000A0000000B00000008000000090000000C0000000D0000000E0000000F000000100000001100000012000000130000001400000016000000150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 AS N'sql_clr_ics.pdb';
GO
PRINT N'Creating Procedure [dbo].[clr_send_ics_invite]...';
GO
CREATE PROCEDURE [dbo].[clr_send_ics_invite]
	@from [nvarchar](4000),
	@to [nvarchar](4000),
	@cc [nvarchar](4000) = null,
	@reply_to [nvarchar](4000) = null,
	@subject [nvarchar](4000),
	@body [nvarchar](4000) = null,
	@location [nvarchar](4000) = null,
	@start_time_utc [datetime] = null,
	@end_time_utc [datetime] = null,
	@timestamp_utc [datetime] = null,
	@smtp_server [nvarchar](4000) = null,
	@port [int] = 25,
	@use_ssl [bit] = 0,
	@username [nvarchar](4000) = null,
	@password [nvarchar](4000) = null,
	@use_reminder [bit] = 1,
	@reminder_minutes [int] = 15,
	@require_rsvp [bit] = 0,
	@cancel_event_identifier [uniqueidentifier] = null,
	@event_identifier [uniqueidentifier] = null OUTPUT,
	@suppress_info_messages [bit] = 0
WITH EXECUTE AS CALLER
AS
EXTERNAL NAME [sql_clr_ics].[StoredProcedures].[clr_send_ics_invite]
GO